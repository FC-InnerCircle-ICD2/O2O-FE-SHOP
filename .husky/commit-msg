COMMIT_MESSAGE_FILE=$1
COMMIT_MESSAGE=$(cat "$COMMIT_MESSAGE_FILE")

# PR Merge Commit ì²˜ë¦¬ í•¨ìˆ˜
process_pr_merge() {
  PR_NUMBER=$(echo "$COMMIT_MESSAGE" | grep -oE "#[0-9]+")
  PR_TITLE=$(echo "$COMMIT_MESSAGE" | sed -nE 's/^Merge pull request #[0-9]+ from [^:]+:?[[:space:]]*(.*)/\1/p')
  echo "ðŸ”€ Merge $PR_NUMBER: $PR_TITLE"
}

# Gitmoji ë§¤í•‘ ì²˜ë¦¬ í•¨ìˆ˜
process_gitmoji() {
  case "$1" in
    Feat)    echo "âœ¨ $COMMIT_MESSAGE" ;;
    Design)  echo "ðŸŽ¨ $COMMIT_MESSAGE" ;;
    Refactor) echo "â™»ï¸ $COMMIT_MESSAGE" ;;
    Fix)     echo "ðŸ› $COMMIT_MESSAGE" ;;
    *)       echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ëŠ” ë‹¤ìŒ í˜•ì‹ì„ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:" 
             echo "   Feat: ê¸°ëŠ¥"
             echo "   Design: ë””ìžì¸/ë¬¸ì„œ ìˆ˜ì •"
             echo "   Refactor: ë¦¬íŒ©í† ë§"
             echo "   Fix: ë²„ê·¸ ìˆ˜ì •"
             exit 1 ;;
  esac
}

# PR Merge Commitì¸ ê²½ìš° ì²˜ë¦¬
if echo "$COMMIT_MESSAGE" | grep -qE "^Merge pull request"; then
  NEW_MESSAGE=$(process_pr_merge)
else
  # Gitmoji ë§¤í•‘ ì²˜ë¦¬
  COMMIT_TYPE=$(echo "$COMMIT_MESSAGE" | cut -d':' -f1)
  NEW_MESSAGE=$(process_gitmoji "$COMMIT_TYPE")
fi

# ì»¤ë°‹ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
echo "$NEW_MESSAGE" > "$COMMIT_MESSAGE_FILE"
